# üìó –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Joy Vision Calculator –Ω–∞ Ubuntu VPS

–ü–æ–¥—Ä–æ–±–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Ubuntu 20.04/22.04/24.04.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#1-–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
2. [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É](#2-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ-–∫-—Å–µ—Ä–≤–µ—Ä—É)
3. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤](#3-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å–∏—Å—Ç–µ–º–Ω—ã—Ö-–ø–∞–∫–µ—Ç–æ–≤)
4. [–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#4-—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
5. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#5-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
6. [–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#6-—Ä—É—á–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#7-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
8. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–∏—Ç—Ä–∏–∫—Å24](#8-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–∏—Ç—Ä–∏–∫—Å24)
9. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd service](#9-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-systemd-service)
10. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx](#10-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-nginx)
11. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL (HTTPS)](#11-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ssl-https)
12. [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏](#12-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
13. [–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#13-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
14. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#14-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- ‚úÖ Ubuntu 20.04 LTS, 22.04 LTS –∏–ª–∏ 24.04 LTS
- ‚úÖ 2 –ì–ë RAM (–º–∏–Ω–∏–º—É–º), 4 –ì–ë —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- ‚úÖ 10 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- ‚úÖ Root –¥–æ—Å—Ç—É–ø –∏–ª–∏ sudo –ø—Ä–∞–≤–∞
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: 80 (HTTP), 443 (HTTPS)

### –ß—Ç–æ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:
- IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
- SSH –¥–æ—Å—Ç—É–ø (–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∏–ª–∏ SSH –∫–ª—é—á)
- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è HTTPS)

---

## 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### –ò–∑ Windows:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PuTTY –∏–ª–∏ Windows Terminal:
```cmd
ssh root@–≤–∞—à-ip-–∞–¥—Ä–µ—Å
```

### –ò–∑ Linux/Mac:

```bash
ssh root@–≤–∞—à-ip-–∞–¥—Ä–µ—Å
```

–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∫–æ–≥–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

## 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤
sudo apt update

# –û–±–Ω–æ–≤–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
sudo apt upgrade -y
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3.10+ –∏ pip
sudo apt install -y python3 python3-pip python3-venv

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo apt install -y git curl wget build-essential

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –ë–î)
sudo apt install -y postgresql postgresql-contrib

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
sudo apt install -y nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Python
python3 --version
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `Python 3.10.x` –∏–ª–∏ –≤—ã—à–µ

---

## 4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è joyvision
sudo useradd -m -s /bin/bash joyvision

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo passwd joyvision

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è joyvision
sudo su - joyvision
```

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –°–∫–∞—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone <repository-url> /home/joyvision/joy-vision-calculator
cd /home/joyvision/joy-vision-calculator

# –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å —á–µ—Ä–µ–∑ wget (–µ—Å–ª–∏ –Ω–µ—Ç git)
wget <archive-url> -O joy-vision.zip
unzip joy-vision.zip
cd joy-vision-calculator
```

---

## 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞:

```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x install.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
sudo ./install.sh
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫:

‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
‚úÖ –°–æ–∑–¥–∞—ë—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚úÖ –°–æ–∑–¥–∞—ë—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç .env.example –≤ .env
‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
‚úÖ –°–æ–∑–¥–∞—ë—Ç systemd service
‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```
====================================
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
====================================

–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ /home/joyvision/joy-vision-calculator/.env
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ë–∏—Ç—Ä–∏–∫—Å24 (—Å–º. —à–∞–≥ 8)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: sudo systemctl start joyvision
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: sudo systemctl status joyvision
```

**‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —à–∞–≥—É 7**

---

## 6. –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cd /home/joyvision/joy-vision-calculator
python3 -m venv venv
```

### –®–∞–≥ 2: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
source venv/bin/activate
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å `(venv)` –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```bash
mkdir -p data/exports
mkdir -p static/fonts
mkdir -p logs
```

### –®–∞–≥ 5: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
cp .env.example .env
```

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤

```bash
# –í—ã–π—Ç–∏ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è joyvision
exit

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chown -R joyvision:joyvision /home/joyvision/joy-vision-calculator
sudo chmod -R 755 /home/joyvision/joy-vision-calculator
```

---

## 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ .env:

```bash
# –í–æ–π—Ç–∏ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º joyvision
sudo su - joyvision
cd /home/joyvision/joy-vision-calculator

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nano .env
```

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

```env
# Flask –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º–µ
FLASK_ENV=production
FLASK_DEBUG=False

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å SECRET_KEY:
SECRET_KEY=<–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ_–∫–æ–º–∞–Ω–¥—É_–Ω–∏–∂–µ>

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
DATABASE_URL=postgresql://joyvision:password@localhost/joyvision_db

# –ò–ª–∏ SQLite (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
# DATABASE_URL=sqlite:////home/joyvision/joy-vision-calculator/data/joyvision.db

# PDF —ç–∫—Å–ø–æ—Ä—Ç—ã
PDF_EXPORTS_DIR=/home/joyvision/joy-vision-calculator/data/exports

# –ë–∏—Ç—Ä–∏–∫—Å24 (–Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ –≤ —à–∞–≥–µ 8)
BITRIX24_WEBHOOK_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru/rest/1/–∫–æ–¥/
BITRIX24_FOLDER_ID=3313

# –ü–æ—Ä—Ç –∏ —Ö–æ—Å—Ç –¥–ª—è Gunicorn
PORT=8000
HOST=127.0.0.1
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY:

```bash
python3 -c "import secrets; print(secrets.token_hex(32))"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—ã–≤–æ–¥ –≤ SECRET_KEY

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:

- –ù–∞–∂–º–∏—Ç–µ **Ctrl + X**
- –ù–∞–∂–º–∏—Ç–µ **Y** (–¥–∞)
- –ù–∞–∂–º–∏—Ç–µ **Enter**

---

## 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–∏—Ç—Ä–∏–∫—Å24

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ –∏ ID –ø–∞–ø–∫–∏:

**–°–ª–µ–¥—É–π—Ç–µ —Ç–µ–º –∂–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, —á—Ç–æ –∏ –¥–ª—è Windows:**

1. –í–æ–π–¥–∏—Ç–µ –≤ –ë–∏—Ç—Ä–∏–∫—Å24
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí REST API ‚Üí –í–µ–±—Ö—É–∫–∏ ‚Üí –°–æ–∑–¥–∞—Ç—å
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞: CRM (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å), –î–∏—Å–∫ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å)
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –≤–µ–±—Ö—É–∫–∞
5. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –Ω–∞ –î–∏—Å–∫–µ, –Ω–∞–π–¥–∏—Ç–µ –µ—ë ID –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

**–í—Å—Ç–∞–≤—å—Ç–µ –≤ .env:**
```bash
nano .env
```

```env
BITRIX24_WEBHOOK_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru/rest/1/abcd1234/
BITRIX24_FOLDER_ID=3313
```

---

## 9. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd service

### –°–æ–∑–¥–∞–Ω–∏–µ service —Ñ–∞–π–ª–∞:

```bash
sudo nano /etc/systemd/system/joyvision.service
```

### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```ini
[Unit]
Description=Joy Vision Calculator
After=network.target

[Service]
Type=notify
User=joyvision
Group=joyvision
WorkingDirectory=/home/joyvision/joy-vision-calculator
Environment="PATH=/home/joyvision/joy-vision-calculator/venv/bin"
ExecStart=/home/joyvision/joy-vision-calculator/venv/bin/gunicorn \
    --bind 127.0.0.1:8000 \
    --workers 4 \
    --timeout 120 \
    --access-logfile /home/joyvision/joy-vision-calculator/logs/access.log \
    --error-logfile /home/joyvision/joy-vision-calculator/logs/error.log \
    app:create_app()
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª (Ctrl + X, Y, Enter)

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å systemd
sudo systemctl daemon-reload

# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl enable joyvision

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl start joyvision

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status joyvision
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `Active: active (running)`

---

## 10. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:

```bash
sudo nano /etc/nginx/sites-available/joyvision
```

### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```nginx
server {
    listen 80;
    server_name –≤–∞—à-–¥–æ–º–µ–Ω.ru;  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω –∏–ª–∏ IP

    # –õ–æ–≥–∏
    access_log /var/log/nginx/joyvision-access.log;
    error_log /var/log/nginx/joyvision-error.log;

    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ Gunicorn
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # –¢–∞–π–º–∞—É—Ç—ã
        proxy_connect_timeout 120;
        proxy_send_timeout 120;
        proxy_read_timeout 120;
    }

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    location /static {
        alias /home/joyvision/joy-vision-calculator/static;
        expires 30d;
    }

    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (–¥–ª—è Excel)
    client_max_body_size 10M;
}
```

### –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É
sudo ln -s /etc/nginx/sites-available/joyvision /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
sudo systemctl restart nginx

# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ Nginx
sudo systemctl enable nginx
```

---

## 11. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL (HTTPS)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot:

```bash
sudo apt install -y certbot python3-certbot-nginx
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.ru -d www.–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
1. –í–≤–µ–¥–∏—Ç–µ email
2. –°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ (Y)
3. –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è HTTP ‚Üí HTTPS (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 2)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
sudo certbot renew --dry-run

# –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

## 12. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

```bash
sudo systemctl status joyvision
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Active: active (running)`

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞
sudo journalctl -u joyvision -n 50

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo journalctl -u joyvision -f
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- `http://–≤–∞—à-ip-–∏–ª–∏-–¥–æ–º–µ–Ω/health`

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```json
{
  "status": "ok",
  "app": "Joy Vision Calculator"
}
```

### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ API

```bash
curl -X POST http://localhost:8000/api/orders \
  -H "Content-Type: application/json" \
  -d '{"customer_name": "–¢–µ—Å—Ç"}'
```

–î–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å JSON —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º –∑–∞–∫–∞–∑–æ–º

---

## 13. –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º:

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart joyvision

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo systemctl stop joyvision

# –ó–∞–ø—É—Å–∫
sudo systemctl start joyvision

# –°—Ç–∞—Ç—É—Å
sudo systemctl status joyvision
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f /home/joyvision/joy-vision-calculator/logs/error.log

# –õ–æ–≥–∏ systemd
sudo journalctl -u joyvision -f

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/joyvision-error.log
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# –í–æ–π—Ç–∏ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º joyvision
sudo su - joyvision
cd /home/joyvision/joy-vision-calculator

# –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
git pull

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt --upgrade

# –í—ã–π—Ç–∏
exit

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart joyvision
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (SQLite)
cp /home/joyvision/joy-vision-calculator/data/joyvision.db \
   /home/joyvision/backup-$(date +%Y%m%d).db

# –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
sudo -u postgres pg_dump joyvision_db > backup-$(date +%Y%m%d).sql

# –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp /home/joyvision/joy-vision-calculator/.env \
   /home/joyvision/env-backup-$(date +%Y%m%d)
```

---

## 14. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
sudo systemctl status joyvision
sudo journalctl -u joyvision -n 100
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `ls -la /home/joyvision/joy-vision-calculator`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª: –µ—Å—Ç—å –ª–∏ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ venv –≤ service —Ñ–∞–π–ª–µ

### –ü—Ä–æ–±–ª–µ–º–∞: 502 Bad Gateway

**–ü—Ä–∏—á–∏–Ω–∞:** Gunicorn –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
sudo systemctl restart joyvision
sudo systemctl status joyvision
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

**–î–ª—è PostgreSQL:**
```bash
# –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –≤—Ä—É—á–Ω—É—é
sudo -u postgres psql
CREATE DATABASE joyvision_db;
CREATE USER joyvision WITH PASSWORD 'password';
GRANT ALL PRIVILEGES ON DATABASE joyvision_db TO joyvision;
\q
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∏—Ç—Ä–∏–∫—Å24 –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
curl https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru/rest/1/–∫–æ–¥/crm.deal.list.json
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
df -h
```

**–û—á–∏—Å—Ç–∫–∞:**
```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏
sudo journalctl --vacuum-time=7d

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à apt
sudo apt clean
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º–µ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ.

**–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏–ª–∏:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ SSL/HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- ‚úÖ Nginx –∫–∞–∫ reverse proxy
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- üìä –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Uptime Robot, Pingdom)
- üíæ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- üîí –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall (ufw)
- üìß –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**–ü—Ä–∏—è—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã! üöÄ**
